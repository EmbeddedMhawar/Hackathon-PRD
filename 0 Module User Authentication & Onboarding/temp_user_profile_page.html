<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TokenizeRWA - Account Management</title>
    <link rel="icon" href="data:image/x-icon;base64,">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Noto+Sans:wght@400;500;600;700;900&display=swap" rel="stylesheet" as="style" onload="this.rel='stylesheet'">
    <style type="text/tailwindcss">
        :root {
            --primary-color: #019863;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --input-bg: #f9fafb;
            --input-focus-border: #019863;
            --button-hover-bg: #017a50;
            --active-tab-border: var(--primary-color);
            --inactive-tab-border: transparent;
            --error-color: #ef4444; /* Tailwind's red-500 */
            --success-color: #22c55e; /* Tailwind's green-500 */
        }
        .form-input {
            @apply w-full rounded-lg border border-[var(--border-color)] bg-[var(--input-bg)] p-3 text-base text-[var(--text-primary)] placeholder-[var(--text-secondary)] focus:border-[var(--input-focus-border)] focus:ring-1 focus:ring-[var(--input-focus-border)] transition-colors duration-200;
        }
        .form-input-disabled { /* Corrected from previous attempts to ensure it's used */
            @apply w-full rounded-lg border border-gray-300 bg-gray-100 p-3 text-base text-gray-500 cursor-not-allowed;
        }
        .form-checkbox {
            @apply h-5 w-5 rounded border-[var(--border-color)] bg-transparent text-[var(--primary-color)] checked:bg-[var(--primary-color)] checked:border-[var(--primary-color)] checked:bg-[url('data:image/svg+xml,%3csvg viewBox=%270 0 16 16%27 fill=%27rgb(255,255,255)%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3cpath d=%27M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z%27/%3e%3c/svg%3e')] focus:ring-0 focus:ring-offset-0 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--primary-color)];
        }
        .tab-button {
            @apply px-4 py-2.5 font-medium text-sm border-b-2 focus:outline-none transition-colors duration-150;
        }
        .tab-button.active {
            @apply border-[var(--active-tab-border)] text-[var(--primary-color)];
        }
        .tab-button.inactive {
            @apply border-[var(--inactive-tab-border)] text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:border-gray-300;
        }
        .form-label-group { @apply block mb-1 text-sm font-medium text-[var(--text-primary)]; }
        .save-button {
             @apply py-2.5 px-5 text-sm font-semibold text-white bg-[var(--primary-color)] hover:bg-[var(--button-hover-bg)] rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--primary-color)] transition-colors duration-200 disabled:opacity-50;
        }
    </style>
</head>
<body class="bg-slate-50 text-[var(--text-primary)]" style="font-family: Inter, 'Noto Sans', sans-serif;">
    <div class="flex min-h-screen flex-col items-center bg-slate-50 px-4 py-8 sm:py-12 lg:py-16">
        <div class="w-full max-w-3xl mx-auto bg-white shadow-xl rounded-lg p-6 md:p-8">
            <header class="mb-10">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold tracking-tight text-[var(--text-primary)]">Account Management</h1>
                        <p class="text-base text-[var(--text-secondary)] mt-1">Manage your profile, security, and notification settings.</p>
                    </div>
                    <div class="flex items-center justify-center h-16 w-16 rounded-full bg-[var(--primary-color)] text-white text-2xl font-semibold">
                        <span id="userInitials">JD</span>
                    </div>
                </div>
            </header>

            <div class="mb-8 border-b border-[var(--border-color)]">
                <nav class="-mb-px flex space-x-1 sm:space-x-4" aria-label="Tabs">
                    <button id="tabProfile" data-tab="profile" class="tab-button active">Profile Information</button>
                    <button id="tabSecurity" data-tab="security" class="tab-button inactive">Security</button>
                    <button id="tabNotifications" data-tab="notifications" class="tab-button inactive">Notifications</button>
                </nav>
            </div>

            <div id="tabContent">
                <!-- Profile Information Tab -->
                <div id="profileContent" class="tab-pane space-y-6">
                    <h2 class="text-xl font-semibold text-[var(--text-primary)]">Personal Details</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="emailDisplayField" class="form-label-group">Email Address</label>
                            <input type="email" id="emailDisplayField" class="form-input-disabled" value="john.doe@example.com" disabled>
                        </div>
                        <div>
                            <label for="kycStatusDisplayField" class="form-label-group">KYC Status</label>
                            <input type="text" id="kycStatusDisplayField" class="form-input-disabled font-semibold text-[var(--success-color)]" value="Verified" disabled>
                        </div>
                    </div>
                    <hr class="my-6 border-[var(--border-color)]">
                    <form id="profileForm" class="space-y-6">
                        <div>
                            <label for="fullName" class="form-label-group">Full Name</label>
                            <input type="text" name="fullName" id="fullName" class="form-input" value="John Doe" required>
                        </div>
                        <div>
                            <label for="phoneNumber" class="form-label-group">Phone Number</label>
                            <input type="tel" name="phoneNumber" id="phoneNumber" class="form-input" value="+1234567890" required>
                        </div>
                        <div>
                            <label for="residentialAddress" class="form-label-group">Residential Address</label>
                            <textarea name="residentialAddress" id="residentialAddress" class="form-input" rows="3" required>123 Main Street, Anytown, USA 12345</textarea>
                        </div>
                        <div class="flex justify-end">
                            <button type="submit" class="save-button">Save Profile Changes</button>
                        </div>
                    </form>
                </div>

                <!-- Security Settings Tab -->
                <div id="securityContent" class="tab-pane space-y-8 hidden">
                    <h2 class="text-xl font-semibold text-[var(--text-primary)]">Security Configuration</h2>

                    <div>
                        <h3 class="text-lg font-medium text-[var(--text-primary)] mb-2">Change Password</h3>
                        <button id="showChangePasswordFormButton" class="text-sm font-medium text-[var(--primary-color)] hover:text-[var(--button-hover-bg)] underline">Click to change your password</button>
                        <form id="changePasswordForm" class="mt-4 space-y-4 hidden p-4 border border-[var(--border-color)] rounded-md bg-slate-50">
                            <div>
                                <label for="currentPassword" class="form-label-group">Current Password</label>
                                <input type="password" name="currentPassword" id="currentPassword" class="form-input" placeholder="Enter current password" required>
                            </div>
                            <div>
                                <label for="newPassword" class="form-label-group">New Password</label>
                                <input type="password" name="newPassword" id="newPassword" class="form-input" placeholder="Enter new password (min. 8 characters)" required>
                            </div>
                            <div>
                                <label for="confirmNewPassword" class="form-label-group">Confirm New Password</label>
                                <input type="password" name="confirmNewPassword" id="confirmNewPassword" class="form-input" placeholder="Confirm new password" required>
                                <p id="passwordMismatchError" class="text-xs text-[var(--error-color)] mt-1 hidden">New passwords do not match.</p>
                                <p id="passwordPolicyError" class="text-xs text-[var(--error-color)] mt-1 hidden">Password must be at least 8 characters.</p>
                            </div>
                            <div class="flex justify-end space-x-3">
                                <button type="button" id="cancelPasswordChangeButton" class="py-2 px-4 text-sm font-medium text-[var(--text-secondary)] hover:bg-gray-100 rounded-lg border border-[var(--border-color)]">Cancel</button>
                                <button type="submit" id="submitPasswordChangeButton" class="save-button" disabled>Submit Password Change</button>
                            </div>
                        </form>
                    </div>
                    <hr class="my-6 border-[var(--border-color)]">
                    <div>
                        <h3 class="text-lg font-medium text-[var(--text-primary)] mb-2">Two-Factor Authentication (2FA)</h3>
                        <p class="text-base text-[var(--text-secondary)]">Status: <span class="font-semibold text-orange-500">Not Configured</span></p>
                        <button class="mt-2 text-sm font-medium text-[var(--primary-color)] hover:text-[var(--button-hover-bg)] underline">[Enable 2FA]</button>
                    </div>
                    <hr class="my-6 border-[var(--border-color)]">
                    <div>
                        <h3 class="text-lg font-medium text-[var(--text-primary)] mb-2">Recent Login Activity</h3>
                        <p class="text-sm text-[var(--text-secondary)]">Last login: <span id="lastLoginTime" class="font-medium">Oct 26, 2023, 10:00 AM UTC</span> from IP <span id="lastLoginIp" class="font-medium">192.168.1.100</span> (example)</p>
                        <a href="#" class="mt-1 text-sm font-medium text-[var(--primary-color)] hover:text-[var(--button-hover-bg)] underline">View all login activity</a>
                    </div>
                </div>

                <!-- Notification Preferences Tab -->
                <div id="notificationsContent" class="tab-pane space-y-6 hidden">
                    <h2 class="text-xl font-semibold text-[var(--text-primary)]">Notification Settings</h2>
                    <form id="notificationsForm" class="space-y-5">
                        <p class="text-base text-[var(--text-secondary)]">Choose how you want to be notified.</p>
                        <div class="relative flex items-start">
                            <div class="flex h-6 items-center">
                                <input id="notifTransaction" name="notifTransaction" type="checkbox" class="form-checkbox" checked>
                            </div>
                            <div class="ml-3 text-sm leading-6">
                                <label for="notifTransaction" class="font-medium text-[var(--text-primary)]">Transaction Alerts</label>
                                <p class="text-[var(--text-secondary)] text-xs">Receive alerts for successful transactions, failed attempts, etc.</p>
                            </div>
                        </div>
                        <div class="relative flex items-start">
                            <div class="flex h-6 items-center">
                                <input id="notifUpdates" name="notifUpdates" type="checkbox" class="form-checkbox" checked>
                            </div>
                            <div class="ml-3 text-sm leading-6">
                                <label for="notifUpdates" class="font-medium text-[var(--text-primary)]">Platform Updates</label>
                                <p class="text-[var(--text-secondary)] text-xs">Get notified about new features, maintenance, and important announcements.</p>
                            </div>
                        </div>
                        <div class="relative flex items-start">
                            <div class="flex h-6 items-center">
                                <input id="notifMarketing" name="notifMarketing" type="checkbox" class="form-checkbox">
                            </div>
                            <div class="ml-3 text-sm leading-6">
                                <label for="notifMarketing" class="font-medium text-[var(--text-primary)]">Marketing & Promotional</label>
                                <p class="text-[var(--text-secondary)] text-xs">Receive info about new investment opportunities and special offers.</p>
                            </div>
                        </div>
                        <div class="flex justify-end pt-4">
                            <button type="submit" class="save-button">Save Notification Preferences</button>
                        </div>
                    </form>
                </div>
            </div>
             <div id="toast" class="fixed bottom-5 right-5 bg-gray-800 text-white py-2.5 px-5 rounded-lg shadow-md hidden opacity-0 transition-opacity duration-300 text-sm">
                Settings saved!
            </div>
        </div>
    </div>

<script>
    const tabs = document.querySelectorAll('.tab-button');
    const tabPanes = document.querySelectorAll('.tab-pane');
    const userInitialsEl = document.getElementById('userInitials');
    const emailDisplayEl = document.getElementById('emailDisplayField'); // Changed to match input ID

    if (emailDisplayEl && userInitialsEl) {
        const email = emailDisplayEl.value.trim(); // Use .value for input fields
        if (email) {
            const nameParts = email.split('@')[0].split(/[._-]/);
            let initials = nameParts.map(part => part.charAt(0).toUpperCase()).join('');
            if (initials.length > 2) initials = initials.substring(0, 2);
            else if (initials.length === 1 && nameParts[0].length > 1) {
                 initials += nameParts[0].charAt(1).toUpperCase();
            }
             if(initials.length == 0 && email.length > 0) initials = email.substring(0,2).toUpperCase();
            userInitialsEl.textContent = initials || 'N/A';
        }
    }

    tabs.forEach(tab => {
        tab.addEventListener('click', (e) => {
            e.preventDefault();
            const targetTab = tab.dataset.tab;

            tabs.forEach(t => {
                t.classList.remove('active');
                t.classList.add('inactive');
            });
            tab.classList.add('active');
            tab.classList.remove('inactive');

            tabPanes.forEach(pane => {
                pane.classList.toggle('hidden', pane.id !== `${targetTab}Content`);
            });

            if (targetTab !== 'security') {
                 document.getElementById('changePasswordForm').classList.add('hidden');
                 document.getElementById('showChangePasswordFormButton').classList.remove('hidden');
            }
        });
    });

    const toastEl = document.getElementById('toast');
    function showToast(message) {
        toastEl.textContent = message;
        toastEl.classList.remove('hidden');
        toastEl.classList.add('opacity-100');
        setTimeout(() => {
            toastEl.classList.remove('opacity-100');
            toastEl.classList.add('hidden');
        }, 3000);
    }

    document.getElementById('profileForm').addEventListener('submit', function(event) {
        event.preventDefault();
        showToast('Profile information saved! (Simulated)');
    });

    const showChangePasswordFormButtonEl = document.getElementById('showChangePasswordFormButton');
    const changePasswordFormEl = document.getElementById('changePasswordForm');
    const cancelPasswordChangeButtonEl = document.getElementById('cancelPasswordChangeButton');
    const currentPasswordInputEl = document.getElementById('currentPassword');
    const newPasswordInputEl = document.getElementById('newPassword');
    const confirmNewPasswordInputEl = document.getElementById('confirmNewPassword');
    const passwordMismatchErrorEl = document.getElementById('passwordMismatchError');
    const passwordPolicyErrorEl = document.getElementById('passwordPolicyError');
    const submitPasswordChangeButtonEl = document.getElementById('submitPasswordChangeButton');

    showChangePasswordFormButtonEl.addEventListener('click', () => {
        changePasswordFormEl.classList.remove('hidden');
        showChangePasswordFormButtonEl.classList.add('hidden');
        changePasswordFormEl.reset();
        passwordMismatchErrorEl.classList.add('hidden');
        passwordPolicyErrorEl.classList.add('hidden');
        submitPasswordChangeButtonEl.disabled = true;
    });

    cancelPasswordChangeButtonEl.addEventListener('click', () => {
        changePasswordFormEl.classList.add('hidden');
        showChangePasswordFormButtonEl.classList.remove('hidden');
    });

    function validatePasswordChangeForm() {
        let allValid = true;
        passwordPolicyErrorEl.classList.add('hidden'); // Reset errors
        passwordMismatchErrorEl.classList.add('hidden');

        if (!currentPasswordInputEl.value) { // Current password must not be empty
            allValid = false;
        }
        if (newPasswordInputEl.value.length < 8) { // New password policy
            if (newPasswordInputEl.value.length > 0) { // Only show if user started typing new pass
                 passwordPolicyErrorEl.classList.remove('hidden');
            }
            allValid = false;
        }
        if (newPasswordInputEl.value !== confirmNewPasswordInputEl.value) { // Passwords must match
             if (confirmNewPasswordInputEl.value.length > 0) { // Only show if user started typing confirm pass
                passwordMismatchErrorEl.classList.remove('hidden');
             }
            allValid = false;
        }
         if (!newPasswordInputEl.value || !confirmNewPasswordInputEl.value) { // Both new pass fields must be filled
            allValid = false;
        }
        submitPasswordChangeButtonEl.disabled = !allValid;
    }

    [currentPasswordInputEl, newPasswordInputEl, confirmNewPasswordInputEl].forEach(input => {
        input.addEventListener('input', validatePasswordChangeForm);
    });

    changePasswordFormEl.addEventListener('submit', function(event) {
        event.preventDefault();
        validatePasswordChangeForm();
        if (!submitPasswordChangeButtonEl.disabled) {
            showToast('Password changed successfully! (Simulated)');
            changePasswordFormEl.reset();
            changePasswordFormEl.classList.add('hidden');
            showChangePasswordFormButtonEl.classList.remove('hidden');
            submitPasswordChangeButtonEl.disabled = true;
        } else {
            // This case should ideally not be reached if button is disabled,
            // but as a fallback:
            showToast('Password change failed. Please check errors. (Simulated)');
        }
    });

    document.getElementById('notificationsForm').addEventListener('submit', function(event) {
        event.preventDefault();
        showToast('Notification preferences saved! (Simulated)');
    });

    // Default to Profile Tab
    if (tabs.length > 0) tabs[0].click();
</script>
</body>
</html>
